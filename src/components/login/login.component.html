<div class="login-page-bg">
    
    <a (click)="showLanding.emit()" class="absolute top-6 left-6 text-white/80 hover:text-white font-semibold flex items-center gap-2 cursor-pointer group z-20">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 transition-transform group-hover:-translate-x-1">
            <path fill-rule="evenodd" d="M17 10a.75.75 0 0 1-.75.75H5.612l4.158 3.96a.75.75 0 1 1-1.04 1.08l-5.5-5.25a.75.75 0 0 1 0-1.08l5.5-5.25a.75.75 0 1 1 1.04 1.08L5.612 9.25H16.25A.75.75 0 0 1 17 10Z" clip-rule="evenodd" />
        </svg>
        Back to Home
    </a>
    <div class="login-container">
        <div class="logo-container cursor-pointer" (click)="showLanding.emit()" title="Back to Home">
            <img [src]="logo()" alt="Prime Communication" class="logo">
        </div>

        @if (view() === 'login') {
            <div class="animate-fade-in">
                <h2>Welcome Back</h2>
                <p class="subtitle">Sign in to continue to your dashboard</p>

                <form [formGroup]="loginForm" (ngSubmit)="onLoginSubmit()">
                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <div class="input-wrapper">
                            <input type="email" id="email" formControlName="email" placeholder="Enter your email address" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="password">Password</label>
                        <div class="input-wrapper">
                            <input type="password" id="password" formControlName="password" placeholder="Enter your password" required>
                        </div>
                    </div>

                    <div class="forgot-password">
                        <a (click)="view.set('forgotPassword')" class="cursor-pointer">Forgot password?</a>
                    </div>

                    @if (loginError(); as error) {
                      <div class="login-error">
                        <p>{{ error }}</p>
                      </div>
                    }

                    <button type="submit" class="sign-in-btn" [disabled]="loginForm.invalid || isLoading()">
                        <span>
                            @if (isLoading()) {
                                Signing In...
                            } @else {
                                Sign In
                            }
                        </span>
                    </button>
                </form>

                <div class="divider">
                    <span>or</span>
                </div>

                <div class="signup-link">
                    Need an account? <a [href]="'mailto:' + companyEmail() + '?subject=Request%20for%20New%20User%20Account'">Contact your supervisor</a>
                </div>
            </div>
        } @else {
            <div class="animate-fade-in">
                <h2>Reset Password</h2>
                <p class="subtitle">Enter your email to receive a password reset link.</p>
                
                <form [formGroup]="forgotPasswordForm" (ngSubmit)="onForgotPasswordSubmit()">
                    <div class="form-group">
                        <label for="reset-email">Email Address</label>
                        <div class="input-wrapper">
                            <input type="email" id="reset-email" formControlName="email" placeholder="Enter your registered email" required>
                        </div>
                    </div>
                    
                    @if (resetMessage()) {
                        <div class="reset-message" [class.success]="resetSuccess()" [class.error]="!resetSuccess()">
                            <p>{{ resetMessage() }}</p>
                        </div>
                    }

                    <button type="submit" class="sign-in-btn" [disabled]="forgotPasswordForm.invalid || isSendingReset()">
                        <span>
                            @if (isSendingReset()) {
                                Sending Link...
                            } @else {
                                Send Reset Link
                            }
                        </span>
                    </button>
                </form>

                <div class="divider">
                    <span>or</span>
                </div>

                <div class="signup-link">
                    Remember your password? <a (click)="switchToLogin()" class="cursor-pointer">Sign In</a>
                </div>
            </div>
        }
    </div>
</div>